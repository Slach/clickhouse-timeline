clickhouse-client -q "SELECT toStartOfInterval(event_time, INTERVAL 1 minute) AS t, normalized_query_hash, sum(ProfileEvents['OSCPUVirtualTimeMicroseconds']) AS cpu, formatReadableTimeDelta(cpu/1000000) AS cpu_duration FROM system.query_log WHERE event_date >= today() GROUP BY ALL FORMAT TSVRaw" | rare spark -m "([^\t]+)\t([^\t]+)\t([^\t]+)\t([^\t]+)" -e '{timeformat {time {1}} "15:04" }' -e "{2}" -e "{3}" -e "{4}" --rows 50 --scale log2
